# 操作系统原理之内存管理

<Badges :content="[{type: 'tip', text:'操作系统原理'}]" />

## 目录

[[TOC]]

## 存储器和存储单元介绍

内存设备是数字系统（ digital system），可以临时或长期存储数据。从数字计算机到硬盘都有内置的存储设备（memory devices），可以存储用户或制造商的数据。这些数据要么是控制程序的形式，要么是启动系统的程序。因此，为了存储如此大量的数据，内存设备必须有巨大的容量（capacity）。我们面临的挑战是如何建造具有大容量但成本可控的存储设备。存储器设备必须能够存储永久数据（permanent data）和瞬时数据（instantaneous data）。

存储器（Memories）是由寄存器（registers）组成的。存储器中的每个寄存器就是一个存储位置（storage location）。存储位置也被称为内存位置（memory location）。存储器位置是用地址（Address）来识别的。一个存储器可以存储的总位数就是它的容量（capacity）。

一个存储元素（storage element）被称为存储单元（Cell）。每个寄存器是由一个存储元素组成的，其中存储着一位数据（bit）。存储器中的数据分别通过称为写（writing）和读（reading）的过程进行存储（stored）和检索（retrieved）。

![image](https://cdn.staticaly.com/gh/jonsam-ng/image-hosting@master/2022/image.37svthnjjw40.webp)

一个字（word）是一组比特（bits），一个存储单元（memory unit）在这里存储二进制信息。一组8位（bits）的字被称为一个字节（byte）。一个存储单元由数据线（data lines）、地址选择线（address selection lines）和指定传输方向的控制线（control lines）组成。一个存储单元的如下所示：

![image](https://cdn.staticaly.com/gh/jonsam-ng/image-hosting@master/2022/image.a9qycnh9gjk.webp)

数据线提供要存储在存储器中的信息。控制输入线指定数据的直接传输。k-address线指定选择的字。当有k条地址线时，可以访问2<sup>k</sup>个内存字。

以下是一些重要的存储单元 :

- 位（Bit，Binary Units）：位是电气状态（electric state）的逻辑表示。它可以是1或0。
- Nibble：它指的是4个比特的组。
- 字节（Byte）：一个字节是由8个比特组成的一组。
- 字（Word）：它是一个固定位数的组，它因计算机而异，但对每个设备来说是相同的。计算机以字的形式存储信息。

以下是存储单元的转换：

- Kilobyte (kb): 1kb = 1024 byte
- Megabyte (mb): 1mb = 1024 kb
- Gigabyte (gb): 1gb = 1024 mb
- Terabyte (tb): 1tb = 1024 gb
- Petabyte (pb): 1pb = 1024 tb

参考：

- [Random Access Memory (RAM) and Read Only Memory (ROM) - GeeksforGeeks](https://www.geeksforgeeks.org/random-access-memory-ram-and-read-only-memory-rom/)
- [Different Types of RAM (Random Access Memory ) - GeeksforGeeks](https://www.geeksforgeeks.org/different-types-ram-random-access-memory/)
- [Cache Memory - GeeksforGeeks](https://www.geeksforgeeks.org/cache-memory/)
- [Secondary Memory - GeeksforGeeks](https://www.geeksforgeeks.org/secondary-memory/)

## 存储器层次结构设计及其特点

在计算机系统设计（Computer System Design）中，内存层次（Memory Hierarchy）是对内存组织的一种改进，它可以使访问时间（access time）最小化。存储器层次结构是基于一种被称为参考定位（locality of references）的程序行为而开发的。下图清楚地展示了存储器层次结构的不同级别。

![image](https://cdn.staticaly.com/gh/jonsam-ng/image-hosting@master/2022/image.1cd94z9wiyhs.webp)

这种内存层次结构设计主要分为2种类型：

- 外部存储器或二级存储器（External Memory or Secondary Memory）：包括磁盘（Magnetic Disk）、光盘（Optical Disk）、磁带（Magnetic Tape），即处理器通过I/O模块（I/O Module）访问的外围存储设备（peripheral storage devices）。
- 内部存储器或主存储器（Internal Memory or Primary Memory）：由主存储器（Main Memory）、缓存存储器（Cache Memory）和CPU寄存器组成（CPU registers）。这是由处理器直接访问的。

我们可以从上图中推断出存储器层次结构设计的以下特点：

- 容量（Capacity）。它是内存可以存储的总体信息量（global volume of information）。当我们在层次结构中从上到下移动时，容量会增加。
- 访问时间（Access Time）。它是读/写请求（read/write request）和数据可用性（availability of the data）之间的时间间隔。随着我们在层次结构中从上到下的移动，访问时间会增加。
- 性能（Performance）。早些时候，当计算机系统在设计时没有采用内存层次结构，由于访问时间的巨大差异，CPU寄存器和主内存之间的速度差距增加。这导致了系统性能的降低，因此需要加强。这种改进是以内存层次设计（Memory Hierarchy Design）的形式进行的，因为它提高了系统的性能。**提高系统性能的最重要的方法之一是最大限度地减少操作数据所需的内存层次的深度**。
- 单位成本（Cost per bit）。当我们在层次结构中从下往上移动时，单位成本就会增加，即内部存储器比外部存储器成本高。

## 伙伴系统--内存分配技术
